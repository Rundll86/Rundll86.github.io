<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>拓展开发中的工具集 | FS-Context</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="stylesheet" href="https://cdn.staticfile.net/prism-themes/1.9.0/prism-vsc-dark-plus.min.css">
    <meta name="description" content="一个易用的 ScratchExtension TypeScript 上下文">
    
    <link rel="preload" href="/fs-context/assets/css/0.styles.d0670e56.css" as="style"><link rel="preload" href="/fs-context/assets/js/app.0f4650aa.js" as="script"><link rel="preload" href="/fs-context/assets/js/2.829c6cf7.js" as="script"><link rel="preload" href="/fs-context/assets/js/1.ee58d111.js" as="script"><link rel="preload" href="/fs-context/assets/js/24.998016f5.js" as="script"><link rel="prefetch" href="/fs-context/assets/js/10.9ee33c67.js"><link rel="prefetch" href="/fs-context/assets/js/11.69d063a6.js"><link rel="prefetch" href="/fs-context/assets/js/12.ef562b5a.js"><link rel="prefetch" href="/fs-context/assets/js/13.edd6ddf9.js"><link rel="prefetch" href="/fs-context/assets/js/14.eb7f9793.js"><link rel="prefetch" href="/fs-context/assets/js/15.368b6934.js"><link rel="prefetch" href="/fs-context/assets/js/16.36dcfef0.js"><link rel="prefetch" href="/fs-context/assets/js/17.4a5a94c6.js"><link rel="prefetch" href="/fs-context/assets/js/18.44fae16a.js"><link rel="prefetch" href="/fs-context/assets/js/19.b43531ef.js"><link rel="prefetch" href="/fs-context/assets/js/20.d0a57e5f.js"><link rel="prefetch" href="/fs-context/assets/js/21.37e33810.js"><link rel="prefetch" href="/fs-context/assets/js/22.5084003d.js"><link rel="prefetch" href="/fs-context/assets/js/23.aa7ad51f.js"><link rel="prefetch" href="/fs-context/assets/js/25.c424ee57.js"><link rel="prefetch" href="/fs-context/assets/js/26.c9f8207f.js"><link rel="prefetch" href="/fs-context/assets/js/27.564ef5df.js"><link rel="prefetch" href="/fs-context/assets/js/28.0d46daf1.js"><link rel="prefetch" href="/fs-context/assets/js/29.0b880f58.js"><link rel="prefetch" href="/fs-context/assets/js/3.148dc95b.js"><link rel="prefetch" href="/fs-context/assets/js/4.3725f474.js"><link rel="prefetch" href="/fs-context/assets/js/5.1fc572a8.js"><link rel="prefetch" href="/fs-context/assets/js/6.512b55cd.js"><link rel="prefetch" href="/fs-context/assets/js/7.910fb95f.js"><link rel="prefetch" href="/fs-context/assets/js/vendors~docsearch.a22722c0.js">
    <link rel="stylesheet" href="/fs-context/assets/css/0.styles.d0670e56.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/fs-context/" class="home-link router-link-active"><!----> <span class="site-name">FS-Context</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>拓展开发中的工具集</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/fs-context/guide/api/unnecessary.html#可能必要的" class="sidebar-link">可能必要的...</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fs-context/guide/api/unnecessary.html#waterbox" class="sidebar-link">WaterBox</a></li></ul></li><li><a href="/fs-context/guide/api/unnecessary.html#可能不太必要的" class="sidebar-link">可能不太必要的...</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fs-context/guide/api/unnecessary.html#全局上下文" class="sidebar-link">全局上下文</a></li><li class="sidebar-sub-header"><a href="/fs-context/guide/api/unnecessary.html#链式生成组件树" class="sidebar-link">链式生成组件树</a></li><li class="sidebar-sub-header"><a href="/fs-context/guide/api/unnecessary.html#生成随机数、颜色、字符串等" class="sidebar-link">生成随机数、颜色、字符串等</a></li><li class="sidebar-sub-header"><a href="/fs-context/guide/api/unnecessary.html#uuid自增器" class="sidebar-link">UUID自增器</a></li><li class="sidebar-sub-header"><a href="/fs-context/guide/api/unnecessary.html#处理积木文字" class="sidebar-link">处理积木文字</a></li><li class="sidebar-sub-header"><a href="/fs-context/guide/api/unnecessary.html#处理颜色" class="sidebar-link">处理颜色</a></li><li class="sidebar-sub-header"><a href="/fs-context/guide/api/unnecessary.html#定义的积木参数输入类型投射到tw类型" class="sidebar-link">定义的积木参数输入类型投射到TW类型</a></li><li class="sidebar-sub-header"><a href="/fs-context/guide/api/unnecessary.html#一些新写法的解析器" class="sidebar-link">一些新写法的解析器</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="拓展开发中的工具集"><a href="#拓展开发中的工具集" class="header-anchor">#</a> 拓展开发中的工具集</h1> <p>框架中提供了一些工具集，随意用。</p> <h2 id="可能必要的"><a href="#可能必要的" class="header-anchor">#</a> 可能必要的...</h2> <ol><li>开发拓展总是需要调试的，每次都进入编辑器重载未免显得麻烦。</li> <li>框架提供了一个独立调试器，名为<code>WaterBox</code>。</li> <li><code>WaterBox</code>是一个基于浏览器的调试器，因此需要浏览器支持。</li> <li>在<code>WaterBox</code>中，你可以尽情重载拓展的代码，调试积木逻辑，并且可以查看拓展的输出。</li></ol> <h3 id="waterbox"><a href="#waterbox" class="header-anchor">#</a> WaterBox</h3> <h4 id="启动"><a href="#启动" class="header-anchor">#</a> 启动</h4> <p>安装依赖库，在<a href="..">快速开始</a>处以有，此处不再赘述。</p> <p>在项目根目录下运行<code>yarn dev:ui</code>，即可启动WaterBox。<br>
WaterBox会自动打开浏览器，并跳转到<code>http://localhost:25565</code>，如果浏览器没有自动打开，请手动打开。<br>
网页下方会有一个方框用于显示拓展积木，上方有一个<code>canvas</code>用于预览舞台。点击<code>重载拓展</code>按钮可刷新数据库内容。</p> <h4 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h4> <ol><li>点击积木的<code>Run</code>按钮，可根据输入执行积木函数。</li> <li>点击积木的<code>View</code>按钮，可查看当前积木的opcode、blockType、arguments等信息。</li> <li>点击积木的<code>Arg</code>按钮，可查看当前积木输入的对应参数对象。</li></ol> <h2 id="可能不太必要的"><a href="#可能不太必要的" class="header-anchor">#</a> 可能不太必要的...</h2> <h3 id="全局上下文"><a href="#全局上下文" class="header-anchor">#</a> 全局上下文</h3> <p>使用<code>GlobalContext</code>命名空间的<code>createDataStore</code>方法可以创建一个基于全局变量的数据库，将拓展的数据导出便于调试，也可以便于联动其他拓展。<br>
方法的第一个参数传入拓展派生于<code>Extension</code>的类的原型，第二个参数传入一个对象，对象中的字段将会被导出到全局。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">let</span> dataStore <span class="token operator">=</span> GlobalContext<span class="token punctuation">.</span><span class="token function">createDataStore</span><span class="token punctuation">(</span>MyExtension<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    alertedSth<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//类型断言，转换成string[]，否则会被自动推断为never[]</span>
    lastSuffix<span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>现在修改积木的执行函数，将弹窗的内容添加到数据库中。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">alertSth</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>$sth <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> args<span class="token punctuation">.</span>_suffix<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//数据字段为数组时，能自动判断并且添加元素而不是直接覆盖</span>
    dataStore<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;alertedSth&quot;</span><span class="token punctuation">,</span> args<span class="token punctuation">.</span>$sth<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dataStore<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;lastSuffix&quot;</span><span class="token punctuation">,</span> args<span class="token punctuation">.</span>_suffix<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>现在打开浏览器的开发者工具，在控制台中输入<code>_FSContext.EXPORTED.[拓展ID]</code>即可查看数据库的内容。</p> <h4 id="与其他拓展联动"><a href="#与其他拓展联动" class="header-anchor">#</a> 与其他拓展联动</h4> <p>在任意时刻，都可以使用<code>GlobalContext</code>命名空间的<code>getDataStore</code>方法来获取其他拓展的已导出数据。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">alertSth</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>$sth <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> args<span class="token punctuation">.</span>_suffix<span class="token punctuation">)</span><span class="token punctuation">;</span>
    dataStore<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;alertedSth&quot;</span><span class="token punctuation">,</span> args<span class="token punctuation">.</span>$sth<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dataStore<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;lastSuffix&quot;</span><span class="token punctuation">,</span> args<span class="token punctuation">.</span>_suffix<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//------------------------------------------↓↓↓其他拓展的数据库的类型声明↓↓↓</span>
    <span class="token keyword">let</span> otherDataStore <span class="token operator">=</span> GlobalContext<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">getDataStore</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token punctuation">{</span> lastSuffix<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;其他拓展ID&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dataStore<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;alertedSth&quot;</span><span class="token punctuation">,</span> otherDataStore<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token string">&quot;alertedSth&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将其他拓展的数据写入自己的数据库</span>
    otherDataStore<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;lastSuffix&quot;</span><span class="token punctuation">,</span> args<span class="token punctuation">.</span>_suffix<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将自己的数据写入其他拓展的数据库</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="链式生成组件树"><a href="#链式生成组件树" class="header-anchor">#</a> 链式生成组件树</h3> <p>使用<code>Unnecessary</code>命名空间的<code>elementTree</code>方法可链式生成组件树，该方法返回一个<code>ElementContext</code>接口的实现，该对象具有<code>child</code>方法用于添加子组件，<code>class</code>方法用于添加类名，<code>attribute</code>方法用于添加属性，<code>style</code>方法用于添加样式。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Unnecessary <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> tree <span class="token operator">=</span> Unnecessary<span class="token punctuation">.</span><span class="token function">elementTree</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span><span class="token punctuation">[</span>
    <span class="token comment">//子元素</span>
    Unnecessary<span class="token punctuation">.</span><span class="token function">elementTree</span><span class="token punctuation">(</span><span class="token string">&quot;span&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">attribute</span><span class="token punctuation">(</span><span class="token string">&quot;innerText&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;orange&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Unnecessary<span class="token punctuation">.</span><span class="token function">elementTree</span><span class="token punctuation">(</span><span class="token string">&quot;span&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">attribute</span><span class="token punctuation">(</span><span class="token string">&quot;innerText&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">class</span><span class="token punctuation">(</span><span class="token string">&quot;my-class&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;another-class&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;anymore---&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">attribute</span><span class="token punctuation">(</span><span class="token string">&quot;data-attr&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>这棵树最终会被渲染成：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>my-class another-class anymore---<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-attr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>value<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">color</span><span class="token punctuation">:</span> orange<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>hello<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="生成随机数、颜色、字符串等"><a href="#生成随机数、颜色、字符串等" class="header-anchor">#</a> 生成随机数、颜色、字符串等</h3> <p>使用<code>Unnecessary</code>命名空间的以<code>random</code>作前缀的方法可生成随机内容。此处不过多赘述</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Unnecessary <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> randomInt <span class="token operator">=</span> Unnecessary<span class="token punctuation">.</span><span class="token function">randomInt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> randomFloat <span class="token operator">=</span> Unnecessary<span class="token punctuation">.</span><span class="token function">randomFloat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> randomColor <span class="token operator">=</span> Unnecessary<span class="token punctuation">.</span><span class="token function">randomColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> randomString <span class="token operator">=</span> Unnecessary<span class="token punctuation">.</span><span class="token function">randomString</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;abcdefABCDEF123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="uuid自增器"><a href="#uuid自增器" class="header-anchor">#</a> UUID自增器</h3> <p>使用<code>Unnecessary</code>命名空间的<code>UUIDAutoscalator</code>类可生成自增的UUID，每次调用都会返回一个不同的UUID。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Unnecessary <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> machine <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Unnecessary</span><span class="token punctuation">.</span><span class="token function">UUIDAutoscalator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> uuid <span class="token operator">=</span> machine<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>uuid<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//输出类似&quot;XXXX-XXXX-XXXX-XXXX&quot;的字符串</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="处理积木文字"><a href="#处理积木文字" class="header-anchor">#</a> 处理积木文字</h3> <h4 id="切割得到参数框"><a href="#切割得到参数框" class="header-anchor">#</a> 切割得到参数框</h4> <p>使用<code>Unnecessary.splitArgBoxPart</code>方法，切割传入积木文字，得到每个参数框按照对应位置排序的名称数组。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Unnecessary <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> args <span class="token operator">=</span> Unnecessary<span class="token punctuation">.</span><span class="token function">splitArgBoxPart</span><span class="token punctuation">(</span><span class="token string">&quot;alert $sth $sth $sth to window with _suffix&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;$sth&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;_suffix&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//输出[&quot;$sth&quot;, &quot;$sth&quot;, &quot;$sth&quot;, &quot;_suffix&quot;]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="切割得到参数框外的文字"><a href="#切割得到参数框外的文字" class="header-anchor">#</a> 切割得到参数框外的文字</h4> <p>使用<code>Unnecessary.splitTextPart</code>方法，切割传入积木文字，得到参数框外的文字数组。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Unnecessary <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> args <span class="token operator">=</span> Unnecessary<span class="token punctuation">.</span><span class="token function">splitTextPart</span><span class="token punctuation">(</span><span class="token string">&quot;alert $sth $sth $sth to window with _suffix&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;$sth&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;_suffix&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//输出[&quot;alert &quot;, &quot; to window with &quot;, &quot;&quot;]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="处理颜色"><a href="#处理颜色" class="header-anchor">#</a> 处理颜色</h3> <h4 id="hex转rgb数组"><a href="#hex转rgb数组" class="header-anchor">#</a> HEX转RGB数组</h4> <p>使用<code>Unnecessary.hexToRgb</code>方法，将传入的HEX颜色值转换成RGB数组。无需多言。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Unnecessary <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> rgb <span class="token operator">=</span> Unnecessary<span class="token punctuation">.</span><span class="token function">hexToRGB</span><span class="token punctuation">(</span><span class="token string">&quot;#FF00FF&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rgb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//输出[255, 0, 255]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="使颜色加深-混入黑色"><a href="#使颜色加深-混入黑色" class="header-anchor">#</a> 使颜色加深（混入黑色）</h4> <p>使用<code>Unnecessary.darken</code>方法来加深颜色，即降低HSL亮度。首先传入一个HEX颜色，再传入加深的比例。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Unnecessary <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> hex <span class="token operator">=</span> Unnecessary<span class="token punctuation">.</span><span class="token function">darken</span><span class="token punctuation">(</span><span class="token string">&quot;#FF00FF&quot;</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>hex<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//输出&quot;#800080&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="使颜色变浅-混入白色"><a href="#使颜色变浅-混入白色" class="header-anchor">#</a> 使颜色变浅（混入白色）</h4> <p>使用<code>Unnecessary.lighten</code>方法来变浅颜色，即提高HSL亮度。首先传入一个HEX颜色，再传入变浅的比例。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Unnecessary <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> hex <span class="token operator">=</span> Unnecessary<span class="token punctuation">.</span><span class="token function">lighten</span><span class="token punctuation">(</span><span class="token string">&quot;#FF00FF&quot;</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>hex<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//输出&quot;#FF80FF&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="定义的积木参数输入类型投射到tw类型"><a href="#定义的积木参数输入类型投射到tw类型" class="header-anchor">#</a> 定义的积木参数输入类型投射到TW类型</h3> <p>使用<code>Unnecessary.castInputType</code>方法，将传入的积木参数类型投射到TW类型。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Unnecessary <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> type <span class="token operator">=</span> Unnecessary<span class="token punctuation">.</span><span class="token function">castInputType</span><span class="token punctuation">(</span><span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//输出&quot;string&quot;</span>
<span class="token keyword">let</span> type <span class="token operator">=</span> Unnecessary<span class="token punctuation">.</span><span class="token function">castInputType</span><span class="token punctuation">(</span><span class="token string">&quot;bool&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//输出&quot;Boolean&quot;</span>
<span class="token keyword">let</span> type <span class="token operator">=</span> Unnecessary<span class="token punctuation">.</span><span class="token function">castInputType</span><span class="token punctuation">(</span><span class="token string">&quot;hat-parameter&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//输出&quot;ccw_hat_parameter&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="一些新写法的解析器"><a href="#一些新写法的解析器" class="header-anchor">#</a> 一些新写法的解析器</h3> <h4 id="菜单解析器"><a href="#菜单解析器" class="header-anchor">#</a> 菜单解析器</h4> <p><code>MenuParser</code>命名空间提供了一个用来解析新写法菜单的工具集。新菜单的写法请前往<a href="/fs-context/guide/#更灵活的菜单项写法">快速开始</a>查看。</p> <p>解析器的核心方法为<code>normalize</code>，可将新写法自动解析为完全机器可读的对象。只需传入按照新写法编写的菜单项列表即可。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> MenuParser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
MenuParser<span class="token punctuation">.</span><span class="token function">normalize</span><span class="token punctuation">(</span><span class="token string">&quot;苹果=apple,梨子=pear,香蕉=banana&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回↓</span>
<span class="token comment">/*
[
    {
        name: &quot;苹果&quot;,
        value: &quot;apple&quot;
    },
    {
        name: &quot;梨子&quot;,
        value: &quot;pear&quot;
    },
    {
        name: &quot;香蕉&quot;,
        value: &quot;banana&quot;
    }
]
*/</span>
MenuParser<span class="token punctuation">.</span><span class="token function">normalize</span><span class="token punctuation">(</span><span class="token string">&quot;苹果,梨子,香蕉&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回↓</span>
<span class="token comment">/*
[
    {
        name: &quot;苹果&quot;,
        value: &quot;苹果&quot;
    },
    {
        name: &quot;梨子&quot;,
        value: &quot;梨子&quot;
    },
    {
        name: &quot;香蕉&quot;,
        value: &quot;香蕉&quot;
    }
]
*/</span>
MenuParser<span class="token punctuation">.</span><span class="token function">normalize</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token string">&quot;苹果&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;梨子=pear&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">&quot;香蕉&quot;</span><span class="token punctuation">,</span>
        value<span class="token operator">:</span> <span class="token string">&quot;banana&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回↓</span>
<span class="token comment">/*
[
    {
        name: &quot;苹果&quot;,
        value: &quot;苹果&quot;
    },
    {
        name: &quot;梨子&quot;,
        value: &quot;pear&quot;
    },
    {
        name: &quot;香蕉&quot;,
        value: &quot;banana&quot;
    }
]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div><p>使用<code>trimSpace</code>可去除内容两边空格，会自动判断是否传入了字符串，若不是字符串则无需去除，直接返回自身。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> MenuParser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
MenuParser<span class="token punctuation">.</span><span class="token function">trimSpace</span><span class="token punctuation">(</span><span class="token string">&quot;  苹果  &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;苹果&quot;</span>
MenuParser<span class="token punctuation">.</span><span class="token function">trimSpace</span><span class="token punctuation">(</span><span class="token string">&quot;  梨子 = pear  &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;梨子 = pear&quot;</span>
MenuParser<span class="token punctuation">.</span><span class="token function">trimSpace</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;香蕉&quot;</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">&quot;banana&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
{
    name: &quot;香蕉&quot;,
    value: &quot;banana&quot;
}
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>使用<code>trimSpaceMenuItem</code>可去除可读对象两边的空格，只会返回<code>name</code>和<code>value</code>两个字段。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> MenuParser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
MenuParser<span class="token punctuation">.</span><span class="token function">trimSpaceMenuItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;  香蕉  &quot;</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">&quot; banana &quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
{
    name: &quot;香蕉&quot;,
    value: &quot;banana&quot;
}
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>使用<code>parseKeyValue</code>来解析一个使用等于号连接的键值对字符串。会自动去除两头空格。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> MenuParser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
MenuParser<span class="token punctuation">.</span><span class="token function">parseKeyValue</span><span class="token punctuation">(</span><span class="token string">&quot;苹果=apple&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
{
    name: &quot;苹果&quot;,
    value: &quot;apple&quot;
}
*/</span>
MenuParser<span class="token punctuation">.</span><span class="token function">parseKeyValue</span><span class="token punctuation">(</span><span class="token string">&quot;梨子 = pear&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
{
    name: &quot;梨子&quot;,
    value: &quot;pear&quot;
}
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>使用<code>splitStringArray</code>来切割字符串数组，会自动去除两头空格。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> MenuParser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
MenuParser<span class="token punctuation">.</span><span class="token function">splitStringArray</span><span class="token punctuation">(</span><span class="token string">&quot;苹果,梨子,香蕉&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
[
    &quot;苹果&quot;,
    &quot;梨子&quot;,
    &quot;香蕉&quot;
]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>使用<code>isStringArray</code>和<code>isKeyValueString</code>来分别判断传入的参数是否为字符串数组或键值对字符串。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> MenuParser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
MenuParser<span class="token punctuation">.</span><span class="token function">isStringArray</span><span class="token punctuation">(</span><span class="token string">&quot;苹果,梨子,香蕉&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
MenuParser<span class="token punctuation">.</span><span class="token function">isStringArray</span><span class="token punctuation">(</span><span class="token string">&quot;苹果梨子香蕉&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//false</span>
MenuParser<span class="token punctuation">.</span><span class="token function">isKeyValueString</span><span class="token punctuation">(</span><span class="token string">&quot;苹果=apple,梨子=pear,香蕉=banana&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//false，已经是字符串数组了</span>
MenuParser<span class="token punctuation">.</span><span class="token function">isKeyValueString</span><span class="token punctuation">(</span><span class="token string">&quot;苹果=apple&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="积木文字解析器"><a href="#积木文字解析器" class="header-anchor">#</a> 积木文字解析器</h4> <p><code>TextParser</code>命名空间提供了一个用来解析新写法（实验性）积木文字的工具集。新积木文字的写法请前往<a href="/fs-context/guide/#使用TS装饰器特性定义积木">快速开始</a>查看。</p> <p>解析器的核心方法为<code>parsePart</code>，可将新写法自动解析为完全机器可读的对象。只需传入按照新写法编写的积木文字的字符串即可。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> TextParser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
TextParser<span class="token punctuation">.</span><span class="token function">parsePart</span><span class="token punctuation">(</span><span class="token string">&quot;text1 [argA] text2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回↓</span>
<span class="token comment">/*
[
    ArgumentPart(&quot;text1&quot;, &quot;text&quot;),
    ArgumentPart(&quot;argA&quot;, &quot;input&quot;, &quot;&quot;, &quot;string&quot;),
    ArgumentPart(&quot;text2&quot;, &quot;text&quot;)
]
*/</span>
TextParser<span class="token punctuation">.</span><span class="token function">parsePart</span><span class="token punctuation">(</span><span class="token string">&quot;text1 [argA:bool] text2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回↓</span>
<span class="token comment">/*
[
    ArgumentPart(&quot;text1&quot;, &quot;text&quot;),
    ArgumentPart(&quot;argA&quot;, &quot;input&quot;, false, &quot;bool&quot;),
    ArgumentPart(&quot;text2&quot;, &quot;text&quot;)
]
*/</span>
TextParser<span class="token punctuation">.</span><span class="token function">parsePart</span><span class="token punctuation">(</span><span class="token string">&quot;text1 [argA=福瑞占领世界] text2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回↓</span>
<span class="token comment">/*
[
    ArgumentPart(&quot;text1&quot;, &quot;text&quot;),
    ArgumentPart(&quot;argA&quot;, &quot;input&quot;, &quot;福瑞占领世界&quot;, &quot;string&quot;),
    ArgumentPart(&quot;text2&quot;, &quot;text&quot;)
]
*/</span>
TextParser<span class="token punctuation">.</span><span class="token function">parsePart</span><span class="token punctuation">(</span><span class="token string">&quot;text1 [argA:number=114514] text2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回↓</span>
<span class="token comment">/*
[
    ArgumentPart(&quot;text1&quot;, &quot;text&quot;),
    ArgumentPart(&quot;argA&quot;, &quot;input&quot;, 114514, &quot;number&quot;),
    ArgumentPart(&quot;text2&quot;, &quot;text&quot;)
]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>使用<code>split</code>方法来切割文字和参数框部分，会保留空字符串，用于分别处理后合并。不会自动解析对应的参数框部分，需要手动调用解析方法或进行一些其他处理。</p> <p>返回值有两个字段：<code>text</code>和<code>arg</code>，分别为文字部分和参数框部分。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> TextParser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
TextParser<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;text1 [argA] text2 [argB:bool=true]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回↓</span>
<span class="token comment">/*
{
    text: [&quot;text1 &quot;, &quot; text2&quot;],
    arg: [&quot;argA&quot;, &quot;argB:bool=true&quot;]
}
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>以<code>parse</code>为名称前缀的方法均为解析参数属性的函数。</p> <table><thead><tr><th>名称</th> <th>参数</th> <th>返回值</th> <th>说明</th></tr></thead> <tbody><tr><td>parseName</td> <td>字符串</td> <td>字符串</td> <td>名称</td></tr> <tr><td>parseType</td> <td>字符串</td> <td>字符串</td> <td>输入类型</td></tr> <tr><td>parseDefaultValue</td> <td>字符串</td> <td>字符串</td> <td>默认值</td></tr></tbody></table> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> TextParser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> arg <span class="token operator">=</span> <span class="token string">&quot;argA:bool=true&quot;</span><span class="token punctuation">;</span>
TextParser<span class="token punctuation">.</span><span class="token function">parseName</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;argA&quot;</span>
TextParser<span class="token punctuation">.</span><span class="token function">parseType</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;bool&quot;</span>
TextParser<span class="token punctuation">.</span><span class="token function">parseDefaultValue</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Boolean(true)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>以<code>has</code>为名称前缀的方法同理，不过参数必须有名称，所以也就不存在<code>hasName</code>这一说了。</p> <table><thead><tr><th>名称</th> <th>参数</th> <th>返回值</th> <th>说明</th></tr></thead> <tbody><tr><td>hasType</td> <td>字符串</td> <td>布尔值</td> <td>是否有类型</td></tr> <tr><td>hasDefaultValue</td> <td>字符串</td> <td>布尔值</td> <td>是否有默认值</td></tr></tbody></table> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> TextParser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> arg <span class="token operator">=</span> <span class="token string">&quot;argA:bool=true&quot;</span><span class="token punctuation">;</span>
TextParser<span class="token punctuation">.</span><span class="token function">hasType</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
TextParser<span class="token punctuation">.</span><span class="token function">hasDefaultValue</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
<span class="token keyword">const</span> arg2 <span class="token operator">=</span> <span class="token string">&quot;argB&quot;</span><span class="token punctuation">;</span>
TextParser<span class="token punctuation">.</span><span class="token function">hasType</span><span class="token punctuation">(</span>arg2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//false</span>
TextParser<span class="token punctuation">.</span><span class="token function">hasDefaultValue</span><span class="token punctuation">(</span>arg2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//false</span>
<span class="token keyword">const</span> arg3 <span class="token operator">=</span> <span class="token string">&quot;argC:bool&quot;</span><span class="token punctuation">;</span>
TextParser<span class="token punctuation">.</span><span class="token function">hasType</span><span class="token punctuation">(</span>arg3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
TextParser<span class="token punctuation">.</span><span class="token function">hasDefaultValue</span><span class="token punctuation">(</span>arg3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>若需要动态调用判断方法，为了防止出现报错，尝试调用<code>TextParser.hasName</code>时不会出现报错，但不管传入什么参数，都会永远返回<code>true</code>。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> TextParser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@framework/tools&quot;</span><span class="token punctuation">;</span>
TextParser<span class="token punctuation">.</span><span class="token function">hasName</span><span class="token punctuation">(</span><span class="token string">&quot;argA:bool=true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
TextParser<span class="token punctuation">.</span><span class="token function">hasName</span><span class="token punctuation">(</span><span class="token string">&quot;argB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
TextParser<span class="token punctuation">.</span><span class="token function">hasName</span><span class="token punctuation">(</span><span class="token string">&quot;argC:bool&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><a href="/fs-context/guide/api/general.html">已释放的通用API</a></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/fs-context/assets/js/app.0f4650aa.js" defer></script><script src="/fs-context/assets/js/2.829c6cf7.js" defer></script><script src="/fs-context/assets/js/1.ee58d111.js" defer></script><script src="/fs-context/assets/js/24.998016f5.js" defer></script>
  </body>
</html>
